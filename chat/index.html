<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Private Chat</title>
  </head>
  <body>
    <div id="chat"></div>
    <input type="text" id="recipientInput" placeholder="Recipient ID" />
    <input type="text" id="messageInput" placeholder="Type your message" />
    <button onclick="sendMessage()">Send</button>
    <button onclick="close()">Close</button>

    <script>
      const username = prompt("Enter your username:");
      const password = prompt("Enter your password:");

      const socket = new WebSocket(`ws://127.0.0.1:8090/JOM_war_exploded/chat?username=${username}&password=${password}`);

      socket.onmessage = function (event) {
        const chatDiv = document.getElementById("chat");
        chatDiv.innerHTML += "<p>" + event.data + "</p>";
      };

      function sendMessage() {
        const recipientInput = document.getElementById("recipientInput");
        const messageInput = document.getElementById("messageInput");

        const recipientId = recipientInput.value.trim();
        const message = messageInput.value.trim();

        if (recipientId !== "" && message !== "") {
          const fullMessage = recipientId + ": " + message;
          socket.send(fullMessage);

          // Display the sent message in the chat
          const chatDiv = document.getElementById("chat");
          chatDiv.innerHTML +=
            "<p><strong>You to " +
            recipientId +
            ":</strong> " +
            message +
            "</p>";

          // Clear input fields
          recipientInput.value = "";
          messageInput.value = "";
        } else {
          alert("Recipient ID and message cannot be empty");
        }
      }
    </script>
  </body>
</html>
